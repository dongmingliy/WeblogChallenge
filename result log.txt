Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
15/10/05 02:14:34 INFO Remoting: Starting remoting
15/10/05 02:14:34 INFO Remoting: Remoting started; listening on addresses :[akka.tcp://sparkDriver@192.168.0.12:58724]
15/10/05 02:14:36 INFO Persistence: Property hive.metastore.integral.jdo.pushdown unknown - will be ignored
15/10/05 02:14:36 INFO Persistence: Property datanucleus.cache.level2 unknown - will be ignored
15/10/05 02:14:39 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:39 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:40 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:40 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:41 WARN : Your hostname, DESKTOP-SQEBA8O resolves to a loopback/non-reachable address: fe80:0:0:0:3cce:2f4b:3f57:fff3%net3, but we couldn't find any external IP address!
15/10/05 02:14:42 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MResourceUri" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:43 INFO Persistence: Property hive.metastore.integral.jdo.pushdown unknown - will be ignored
15/10/05 02:14:43 INFO Persistence: Property datanucleus.cache.level2 unknown - will be ignored
15/10/05 02:14:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:45 INFO Query: Reading in results for query "org.datanucleus.store.rdbms.query.SQLQuery@0" since the connection used is closing
15/10/05 02:14:45 INFO Datastore: The class "org.apache.hadoop.hive.metastore.model.MResourceUri" is tagged as "embedded-only" so does not have its own datastore table.
15/10/05 02:14:46 WARN : Your hostname, DESKTOP-SQEBA8O resolves to a loopback/non-reachable address: fe80:0:0:0:3cce:2f4b:3f57:fff3%net3, but we couldn't find any external IP address!
15/10/05 02:14:48 INFO ParseDriver: Parsing command: SELECT (MAX(timestamp) - MIN(timestamp))/1000 AS SessionTimeInSec,IPSessionID, IP FROM (SELECT SUM(is_new_session) OVER (PARTITION BY IP ORDER BY timestamp) AS IPSessionID, SUM(is_new_session) OVER (ORDER BY IP, timestamp) AS SessionID,IP,date,timestamp,url FROM (SELECT IP,timestamp, date, url,CASE WHEN ((timestamp - LAG(timestamp) OVER (PARTITION BY IP ORDER BY timestamp)) > 18000000) OR (LAG(timestamp) OVER (PARTITION BY IP ORDER BY timestamp) IS NULL) THEN 1 ELSE 0 END as is_new_session FROM websessions) as Inner  ) AS OUTER GROUP BY IPSessionID, IP
15/10/05 02:14:48 INFO ParseDriver: Parse Completed
Sessionized: 
                                                                                +----------------+-----------+-------------+
|SessionTimeInSec|IPSessionID|           IP|
+----------------+-----------+-------------+
|        1726.125|          1| 1.186.101.79|
|         769.347|          1|1.186.103.240|
|         504.402|          1| 1.186.103.78|
|          20.065|          1|1.186.108.213|
|         702.406|          1|1.186.108.230|
|         156.087|          1|1.186.108.242|
|         958.412|          1| 1.186.108.28|
|         345.306|          1| 1.186.108.29|
|          79.579|          1| 1.186.108.79|
|        2344.434|          1|1.186.111.224|
|         470.563|          1| 1.186.112.12|
|         759.162|          1| 1.186.112.52|
|         131.195|          1|1.186.114.135|
|         617.433|          1| 1.186.114.45|
|             0.0|          1|1.186.117.150|
|         764.483|          1| 1.186.128.57|
|         744.475|          1|1.186.129.213|
|         955.364|          1|1.186.135.123|
|          918.68|          1|1.186.135.254|
|         277.984|          1|1.186.138.134|
|         825.968|          1| 1.186.138.14|
|          445.31|          1| 1.186.142.40|
|         546.742|          1| 1.186.143.37|
|         917.404|          1|1.186.144.110|
|          149.38|          1|1.186.144.182|
|         879.667|          1|1.186.145.111|
|         479.271|          1|1.186.145.145|
|         698.186|          1| 1.186.145.39|
|         279.976|          1|1.186.146.103|
|             0.0|          1|1.186.146.211|
|         861.874|          1| 1.186.146.89|
|         660.346|          1|1.186.149.194|
|         568.635|          1|1.186.154.240|
|             0.0|          1| 1.186.168.63|
|        1141.449|          1|1.186.170.164|
|        1048.122|          1|1.186.179.175|
|         271.696|          1|1.186.180.114|
|         793.685|          1|1.186.180.154|
|       17765.082|          1|1.186.180.183|
|         569.791|          1|1.186.183.166|
|         763.159|          1|1.186.186.119|
|         960.902|          1|1.186.196.160|
|         640.174|          1|1.186.196.211|
|         555.696|          1| 1.186.196.39|
|         670.714|          1|  1.186.196.5|
|         581.612|          1| 1.186.197.80|
|         666.423|          1|1.186.198.106|
|         511.253|          1|1.186.198.158|
|         233.104|          1| 1.186.198.95|
|             0.0|          1|1.186.199.211|
|         401.943|          1|   1.186.2.42|
|         264.442|          1| 1.186.203.58|
|         915.573|          1|1.186.224.136|
|             0.0|          1|1.186.224.199|
|         411.733|          1| 1.186.224.24|
|         943.184|          1|1.186.232.247|
|             0.0|          1| 1.186.232.55|
|         932.162|          1|1.186.233.109|
|             0.0|          1| 1.186.233.89|
|             0.0|          1| 1.186.235.15|
|         390.626|          1| 1.186.235.69|
|         536.924|          1| 1.186.240.27|
|         123.144|          1| 1.186.245.18|
|       16031.138|          1| 1.186.247.60|
|          50.563|          2| 1.186.247.60|
|        5932.352|          1| 1.186.248.29|
|         963.805|          1| 1.186.249.10|
|         409.461|          1|1.186.249.237|
|         228.416|          1| 1.186.250.45|
|        1558.033|          1| 1.186.28.220|
|           4.064|          2| 1.186.28.220|
|             0.0|          1|  1.186.32.38|
|        6564.679|          2|  1.186.32.38|
|         891.509|          1|  1.186.32.78|
|         480.854|          1|  1.186.33.19|
|         798.709|          1|  1.186.33.25|
|         845.898|          1|  1.186.34.10|
|        7418.801|          1|   1.186.37.1|
|        1050.024|          1|  1.186.37.11|
|          979.35|          2|  1.186.37.11|
|        7362.838|          1|  1.186.37.17|
|          55.752|          1|   1.186.37.2|
|        7388.868|          2|   1.186.37.2|
|          31.827|          1|  1.186.37.20|
|        5762.396|          1|  1.186.37.25|
|        2647.484|          2|  1.186.37.25|
|         758.098|          1|  1.186.37.26|
|        1105.538|          1|  1.186.37.28|
|             0.0|          1|   1.186.37.4|
|             0.0|          1|  1.186.37.46|
|         760.143|          1|  1.186.37.49|
|        1110.385|          1|   1.186.37.5|
|        1962.177|          1|   1.186.38.1|
|         930.919|          2|   1.186.38.1|
|         959.664|          1|  1.186.38.10|
|             0.0|          1|  1.186.38.11|
|         527.543|          1|  1.186.38.17|
|         806.145|          1|  1.186.38.18|
|             0.0|          1|  1.186.38.19|
|         612.511|          2|  1.186.38.19|
+----------------+-----------+-------------+
only showing top 100 rows

Average Session Time is: 
                                                                                +---------------------+
|avg(SessionTimeInSec)|
+---------------------+
|   1345.1708785131013|
+---------------------+

15/10/05 02:15:08 INFO ParseDriver: Parsing command: SELECT COUNT(DISTINCT url) AS uniqueVisits,IPSessionID, IP FROM (SELECT SUM(is_new_session) OVER (PARTITION BY IP ORDER BY timestamp) AS IPSessionID, SUM(is_new_session) OVER (ORDER BY IP, timestamp) AS SessionID,IP,date,timestamp,url FROM (SELECT IP,timestamp, date, url,CASE WHEN ((timestamp - LAG(timestamp) OVER (PARTITION BY IP ORDER BY timestamp)) > 18000000) OR (LAG(timestamp) OVER (PARTITION BY IP ORDER BY timestamp) IS NULL) THEN 1 ELSE 0 END as is_new_session FROM websessions) as Inner  ) AS OUTER GROUP BY IPSessionID, IP
15/10/05 02:15:08 INFO ParseDriver: Parse Completed
                                                                                +------------+-----------+-------------+
|uniqueVisits|IPSessionID|           IP|
+------------+-----------+-------------+
|           2|          1| 1.186.101.79|
|           1|          1|1.186.103.240|
|           1|          1| 1.186.103.78|
|           1|          1|1.186.108.213|
|           1|          1|1.186.108.230|
|           1|          1|1.186.108.242|
|           1|          1| 1.186.108.28|
|           1|          1| 1.186.108.29|
|           1|          1| 1.186.108.79|
|           2|          1|1.186.111.224|
|           1|          1| 1.186.112.12|
|           2|          1| 1.186.112.52|
|           2|          1|1.186.114.135|
|           1|          1| 1.186.114.45|
|           1|          1|1.186.117.150|
|           2|          1| 1.186.128.57|
|           1|          1|1.186.129.213|
|           2|          1|1.186.135.123|
|           1|          1|1.186.135.254|
|           1|          1|1.186.138.134|
|           2|          1| 1.186.138.14|
|           1|          1| 1.186.142.40|
|           1|          1| 1.186.143.37|
|           1|          1|1.186.144.110|
|           1|          1|1.186.144.182|
|           1|          1|1.186.145.111|
|           1|          1|1.186.145.145|
|           1|          1| 1.186.145.39|
|           1|          1|1.186.146.103|
|           1|          1|1.186.146.211|
|           2|          1| 1.186.146.89|
|           1|          1|1.186.149.194|
|           1|          1|1.186.154.240|
|           1|          1| 1.186.168.63|
|           2|          1|1.186.170.164|
|           2|          1|1.186.179.175|
|           1|          1|1.186.180.114|
|           1|          1|1.186.180.154|
|           1|          1|1.186.180.183|
|           1|          1|1.186.183.166|
|           1|          1|1.186.186.119|
|           1|          1|1.186.196.160|
|           1|          1|1.186.196.211|
|           2|          1| 1.186.196.39|
|           1|          1|  1.186.196.5|
|           1|          1| 1.186.197.80|
|           2|          1|1.186.198.106|
|           2|          1|1.186.198.158|
|           1|          1| 1.186.198.95|
|           1|          1|1.186.199.211|
|           1|          1|   1.186.2.42|
|           1|          1| 1.186.203.58|
|           2|          1|1.186.224.136|
|           1|          1|1.186.224.199|
|           1|          1| 1.186.224.24|
|           2|          1|1.186.232.247|
|           1|          1| 1.186.232.55|
|           1|          1|1.186.233.109|
|           1|          1| 1.186.233.89|
|           1|          1| 1.186.235.15|
|           1|          1| 1.186.235.69|
|           1|          1| 1.186.240.27|
|           1|          1| 1.186.245.18|
|           2|          1| 1.186.247.60|
|           1|          2| 1.186.247.60|
|           2|          1| 1.186.248.29|
|           1|          1| 1.186.249.10|
|           1|          1|1.186.249.237|
|           1|          1| 1.186.250.45|
|           1|          1| 1.186.28.220|
|           1|          2| 1.186.28.220|
|           1|          1|  1.186.32.38|
|           1|          2|  1.186.32.38|
|           1|          1|  1.186.32.78|
|           1|          1|  1.186.33.19|
|           1|          1|  1.186.33.25|
|           1|          1|  1.186.34.10|
|           2|          1|   1.186.37.1|
|           2|          1|  1.186.37.11|
|           1|          2|  1.186.37.11|
|           2|          1|  1.186.37.17|
|           1|          1|   1.186.37.2|
|           1|          2|   1.186.37.2|
|           1|          1|  1.186.37.20|
|           2|          1|  1.186.37.25|
|           2|          2|  1.186.37.25|
|           2|          1|  1.186.37.26|
|           2|          1|  1.186.37.28|
|           1|          1|   1.186.37.4|
|           1|          1|  1.186.37.46|
|           1|          1|  1.186.37.49|
|           1|          1|   1.186.37.5|
|           1|          1|   1.186.38.1|
|           1|          2|   1.186.38.1|
|           1|          1|  1.186.38.10|
|           1|          1|  1.186.38.11|
|           2|          1|  1.186.38.17|
|           1|          1|  1.186.38.18|
|           1|          1|  1.186.38.19|
|           1|          2|  1.186.38.19|
+------------+-----------+-------------+
only showing top 100 rows

Top Most enaged users are: 
                                                                                +---------------+---------------------+
|             IP|sum(SessionTimeInSec)|
+---------------+---------------------+
|  119.81.61.166|            67599.287|
|   52.74.219.71|            67548.901|
|  106.186.23.95|            67541.798|
|  54.251.151.39|            67455.568|
|  220.226.206.7|            67331.432|
| 122.252.231.14|            67278.633|
| 176.34.159.236|            67222.505|
| 120.29.232.107|            67143.815|
| 121.58.175.128|            67119.459|
| 117.239.35.226|            67107.322|
|  107.23.255.12|            67014.386|
|  54.240.196.33|            66992.565|
| 177.71.207.172|             66894.54|
|   54.228.16.12|            66749.508|
|  54.252.79.172|            66739.439|
| 54.255.254.236|            66737.778|
|  103.251.228.8|            66659.113|
|  68.180.228.46|            66658.805|
|   59.144.58.37|            66651.076|
| 54.183.255.140|            66593.326|
|   20.139.82.64|             66592.78|
|   125.19.44.66|            66458.444|
| 46.165.195.139|            66434.998|
|   54.232.40.76|            66344.055|
|  54.251.31.140|            66250.728|
|    61.246.57.5|            58326.158|
|   20.139.66.64|            58307.912|
|  103.21.125.77|            58227.273|
|    69.59.28.19|             58117.59|
|  203.91.213.69|            58042.761|
|  192.71.175.30|            57985.246|
| 103.247.208.30|            57714.828|
|  103.21.125.80|            57238.307|
|    103.27.8.43|            56338.758|
|168.235.197.204|            56326.703|
| 180.179.213.71|            56195.596|
|168.235.197.212|            56185.813|
| 180.179.213.94|            56097.013|
| 175.101.80.134|            56034.081|
|   202.12.83.44|            55972.155|
| 203.110.243.21|            55852.816|
| 180.179.213.70|            55815.642|
|   207.46.13.37|            55794.932|
|  14.141.188.34|            55713.386|
|  14.140.80.228|            55706.474|
|  116.50.59.180|            55430.254|
|   203.27.235.5|            55096.157|
| 14.139.249.197|            51853.383|
|  103.21.125.78|            51731.517|
| 125.17.164.241|            51452.694|
|  66.249.71.126|            51209.474|
|   175.101.16.9|            50782.649|
| 164.100.96.254|            50636.633|
|   116.50.79.74|            50177.724|
| 106.51.134.103|            49362.828|
|  54.241.32.108|   49199.759000000005|
| 54.252.254.204|   49052.789000000004|
|    202.3.66.50|            48979.944|
|  54.243.31.236|            48620.125|
|   207.46.13.22|   48516.198000000004|
|  103.27.171.54|   48515.774000000005|
|  54.244.52.204|   48454.657999999996|
|  54.248.220.44|            48410.169|
| 121.243.26.254|            48302.293|
| 54.250.253.236|            48233.648|
|  54.245.168.44|   48139.104999999996|
|   74.125.63.33|            47800.504|
|   185.20.4.220|            47496.118|
|115.113.174.100|             47320.73|
| 202.52.130.254|            47317.668|
|    202.41.10.3|            47304.602|
| 14.139.181.229|            47299.998|
|122.248.161.142|            47150.993|
| 115.248.70.101|            47124.682|
|  121.242.63.60|            47109.222|
| 103.246.106.10|            47043.405|
| 103.22.172.139|            47010.181|
|  103.27.171.50|            47005.296|
| 14.139.185.114|            46985.428|
|  14.139.241.84|            46798.204|
|210.212.144.133|            46753.254|
|  111.93.53.130|            46701.202|
|203.200.213.170|             46562.37|
|  103.253.166.8|   46179.130000000005|
|   14.139.196.4|              46159.1|
|122.248.161.141|            46095.499|
|  171.161.56.16|            46012.109|
|  122.15.11.155|            45937.612|
|  14.139.41.151|            45916.507|
| 180.151.80.140|            45881.106|
|  54.169.191.85|             45802.27|
|  14.139.229.43|            45790.179|
|  122.248.183.1|            45682.392|
|  202.133.60.66|            45548.008|
| 111.93.226.254|   45539.136000000006|
|  103.232.241.5|            45411.327|
|  66.249.71.110|             45322.94|
| 168.235.197.81|            44855.086|
|  74.86.158.109|            44798.659|
|  14.139.226.10|            44547.376|
+---------------+---------------------+
only showing top 100 rows

